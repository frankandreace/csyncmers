# CSyncmers

!!! IN CONSTRUCTION !!!

Comparison (and speedup?) of closed syncmers in pure C. Supports arbitrary k values and s < 64 (using Syng hash function).

- [x] Integrate Syng rolling hash function into Rayan's code
- [x] Test Syng syncmer extraction
- [ ] Fix syncmer iterator as it returns 0 reverse complement hash values.
- [ ] Read curiouscoding blog
- [ ] Watch curiouscoding video

#### Folder
- Executables are in bin/;
- Test to check fucntions is test.sh;
- Source files are in src/;
- Data is in data/;


#### How to run
To compile do:

```
Make all
```
This creates (in bin/) both the syncmer_tree executable (Prof. Kunihiko Sadakane's implementation) and the csyncmer executable (my rewriting/merging of Rayan Chiki's csyncmer and Richard Durbin's syng) functions to compute closed syncmers.

If you do:

```
./test.sh 
```
It runs csyncmer's test on a small example. It is still buggy on syng.

If you do:
```
./bin/syncmer_tree data/chr19_bit.fa
```
You can test Prof. Sasakane implementation.

#### Syng iterator issue
Issue arises when I use syng syncmerIterator (see closed_syncmer_syng.c line 114 "SeqhashIterator *syncmerIterator"), and syncmerNext (see closed_syncmer_syng.c line 193 bool syncmerNext). 

The hash values are generated by advanceHashRC (see closed_syncmer_syng.c line 100), that uses HashRC (see closed_syncmer_syng.c line 90 ). My problem is that the values stored in si->hash are always 0, as hashR is going to 0.

Either there is a bug, either I am setting some parameter wrong in construction.

### Some of existing code

Strobealign code: uses 64-bit smers 
https://github.com/ksahlin/strobealign/blob/71866c31b578e5166c83aaf1fde79d238246490d/src/randstrobes.cpp#L57

Minimap2 code: uses 64-bit smers
https://github.com/lh3/minimap2/blob/c2f07ff2ac8bdc5c6768e63191e614ea9012bd5d/sketch.c#L145-L192

Curiouscoding blog:
https://curiouscoding.nl/posts/fast-minimizers/

Sliding window minimum algorithm explanation:
https://github.com/keegancsmith/Sliding-Window-Minimum?tab=readme-ov-file#sliding-window-minimum-algorithm

SYNG: 
https://github.com/richarddurbin/syng/
